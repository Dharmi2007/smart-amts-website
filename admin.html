<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard | Smart AMTS</title>
  <link rel="stylesheet" href="css/admin.css">
</head>

<body>

<!-- ================= HEADER ================= -->
<header class="app-header">
  <img src="images/logo.jpeg" alt="Smart AMTS Logo" class="logo">
  <h2>Admin Dashboard</h2>
</header>

<!-- ================= BUS LOCATION UPDATE ================= -->
<h3>Update Bus Location</h3>

<select id="busSelect"></select>

<input id="latInput" placeholder="Enter new latitude">
<input id="lngInput" placeholder="Enter new longitude">

<button onclick="updateBusLocation()">Update Location</button>

<!-- ================= AI INSIGHTS ================= -->
<div class="card insight-card">
  <h3>ğŸ§  Smart Insights (AI Generated)</h3>
  <ul id="aiInsights">
    <li>Analyzing data...</li>
  </ul>
</div>

<!-- ================= FEEDBACK SUMMARY ================= -->
<div class="card feedback-summary" onclick="toggleFeedbacks()" style="cursor:pointer">
  ğŸ‘¤ Total Feedbacks: <span id="feedbackCount">0</span>
  <p style="font-size:12px;color:#777;">Click to view feedbacks</p>
</div>

<!-- ================= FEEDBACK PANEL ================= -->
<div id="feedbackSection" class="feedback-box" style="display:none;">
  <h3>ğŸ“‹ User Feedback</h3>

  <div class="filters" style="margin-bottom:10px;">
    <select id="filterBus" onchange="renderFeedbacks()">
      <option value="">All Buses</option>
    </select>

    <select id="filterIssue" onchange="renderFeedbacks()">
      <option value="">All Issues</option>
    </select>

    <input type="date" id="filterDate" onchange="renderFeedbacks()">

    <button onclick="exportFeedbackCSV()">â¬‡ Export CSV</button>
  </div>

  <div id="mostComplained" style="margin:10px 0;"></div>
  <div id="busStats" style="margin:10px 0;"></div>

  <div id="feedbackList"></div>
</div>

<!-- ================= CROWD ANALYTICS SUMMARY ================= -->
<div class="card" onclick="toggleCrowdAnalytics()" style="cursor:pointer">
  ğŸ“Š Crowd Analytics
  <p style="font-size:12px;color:#777;">
    Click to view crowd & demand insights
  </p>
</div>

<!-- ================= CROWD ANALYTICS PANEL ================= -->
<div id="crowdSection" class="feedback-box" style="display:none;">

  <h3>ğŸš Crowd Analytics</h3>

  <!-- Feedback-based crowd -->
  <div id="peakCrowdBus" style="margin:8px 0;"></div>
  <div id="peakCrowdTime" style="margin:8px 0;"></div>

  <h4 style="margin-top:12px;">Bus-wise Crowd Level (Feedback)</h4>
  <div id="crowdBusList"></div>

  <!-- ================= NEW: DEMAND INSIGHTS ================= -->
  <hr style="margin:16px 0;">

  <h4>ğŸ“ˆ Demand-Based Crowd Insights (Trip Registration)</h4>
  <p style="font-size:12px;color:#777;">
    Based on passenger trip registrations (no payment data)
  </p>

  <h4 style="margin-top:10px;">Estimated Passenger Demand</h4>
  <div id="demandBusList"></div>

</div>

<!-- ================= SOS ALERTS ================= -->
<div class="card" onclick="toggleAlerts()" style="cursor:pointer">
  ğŸš¨ SOS / Emergency Alerts
  <p style="font-size:12px;color:#777;">Click to view latest alerts</p>
</div>

<div id="alertSection" class="feedback-box" style="display:none;">
  <h3>ğŸ“¡ Real-Time SOS Alerts</h3>
  <div id="alertList"></div>
</div>

<!-- ================= SCRIPTS ================= -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script src="js/firebase.js"></script>
<script src="js/admin.js"></script>

</body>
</html>
